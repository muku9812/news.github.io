/*!
 * 
 * Presto Player
 * 
 * @author Presto Made, Inc
 * @version 0.1.0
 * @link undefined
 * @license GPL
 * 
 * Copyright (c) 2021 Presto Made, Inc
 * 
 * This software is released under the GPL License
 * https://opensource.org/licenses/GPL
 * 
 * Compiled with the help of https://wpack.io
 * A zero setup Webpack Bundler Script for WordPress
 */
(window.wpackioprestoPlayerdiviJsonp=window.wpackioprestoPlayerdiviJsonp||[]).push([[0],{0:function(e,t){e.exports=React},26:function(e,t){e.exports=ReactDOM},37:function(e,t){e.exports=jQuery},43:function(e,t,n){n(44),e.exports=n(61)},61:function(e,t,n){"use strict";n.r(t);var r=n(37),a=n.n(r),o=n(23),c=n(27),i=n(24),s=n(28),u=n(18),l=n(5),p=n(0),d=n.n(p),f=n(29),b=n(17),h=n(19),v=n.n(h),m=n(42);var O=function(e){var t=e.id,n=e.src,r=Object(p.useState)({}),a=Object(b.a)(r,2),o=a[0],c=a[1],i=Object(p.useState)(!1),s=Object(b.a)(i,2),u=s[0],l=s[1],h=Object(p.useState)("self-hosted"),O=Object(b.a)(h,2),y=O[0],j=O[1],w=Object(p.useState)(1),_=Object(b.a)(w,2),g=_[0],E=_[1];Object(p.useEffect)((function(){E(g+1)}),[t,n,o]),Object(p.useEffect)((function(){C(t)}),[t]),Object(p.useEffect)((function(){j(function(e){if(e){if(e.match(/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/))return"youtube";if(e.match(/(https?:\/\/)?(www\.)?(player\.)?vimeo\.com\/([a-z]*\/)*([‌​0-9]{6,11})[?]?.*/))return"vimeo";if(e.indexOf("https://vz-")>-1&&e.indexOf("b-cdn.net")>-1)return"bunny"}return"self-hosted"}(n))}),[n]);var C=function(){var e=Object(f.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return l(!0),e.prev=3,e.next=6,fetch("/wp-admin/admin-ajax.php",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded","Cache-Control":"no-cache"},body:new URLSearchParams({action:"presto_get_media_attributes",_wpnonce:window.et_fb_options.et_admin_load_nonce,id:t})}).then((function(e){return e.json()}));case 6:n=e.sent,c(n.data);case 8:return e.prev=8,l(!1),e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[3,,8,11]])})));return function(t){return e.apply(this,arguments)}}();return u?d.a.createElement("div",{className:"et-fb-preloader et-fb-preloader__loading"},d.a.createElement("div",{className:"et-fb-loader"})):o.id?(n=n||o.src,"bunny"!==(null==o?void 0:o.provider)||"self-hosted"!==y&&"bunny"!==y?d.a.createElement(m.a,{key:g,video_id:o.id,preset:o.preset,src:n,chapters:o.chapters,tracks:o.tracks,branding:o.branding,blockAttributes:o.blockAttributes,config:o.config,skin:o.skin,analytics:o.analytics,automations:o.automations,provider:y,provider_video_id:o.provider_video_id,youtube:o.youtube}):d.a.createElement("presto-video-curtain-ui",null,d.a.createElement("span",null,"Bunny.net videos cannot be previewed in the DIVI editor due to DIVI iframe having no referrer."),d.a.createElement("presto-player-button",{full:!0,type:"primary",target:"_blank",href:"https://prestoplayer.com/docs/bunny-net-videos-not-showing-in-divi-editor"},"Learn More"))):"Choose A Video"};function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var j=wp.i18n.__,w=function(e){Object(i.a)(n,e);var t=y(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={videos:[]},r}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props.dynamic.url_override;return this.props.video_id?d.a.createElement(O,{id:this.props.video_id,src:e&&e.value&&e.value}):d.a.createElement("presto-video-curtain-ui",null,d.a.createElement("span",null,j("Please select a video.","presto-player")))}}]),n}(p.Component);Object(l.a)(w,"slug","prpl_presto_player");var _=[w],g=n(6),E=n(14),C=n(13),k=n(41),V=n(39),P=n(40),x=n.n(P);function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var I=wp.i18n.__,T=function(e){Object(i.a)(n,e);var t=D(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return e=t.call.apply(t,[this].concat(a)),Object(l.a)(Object(g.a)(e),"createEmotionCacheCustom",(function(e){return Object(E.a)({nonce:e,key:"custom-select-style",container:this.props.container})})),Object(l.a)(Object(g.a)(e),"createEmotionCache",Object(C.a)(e.createEmotionCacheCustom)),e}return n}(k.a),L=function(e){Object(i.a)(n,e);var t=D(n);function n(e){var r;Object(o.a)(this,n),r=t.call(this,e),Object(l.a)(Object(g.a)(r),"fetchVideos",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return fetch("/wp-admin/admin-ajax.php",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded","Cache-Control":"no-cache"},body:new URLSearchParams({action:"presto_fetch_videos",search:e})}).then((function(e){return e.json()})).then((function(e){return e.data||[]}))})),Object(l.a)(Object(g.a)(r),"fetchVideo",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e?fetch("/wp-admin/admin-ajax.php",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded","Cache-Control":"no-cache"},body:new URLSearchParams({action:"presto_fetch_videos",post_id:e})}).then((function(e){return e.json()})).then((function(e){return e.data||[]})):[]})),Object(l.a)(Object(g.a)(r),"loadVideos",function(){var e=Object(f.a)(v.a.mark((function e(t){var n,a,o,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=S({searchTerm:"",postId:""},t),e.next=3,Promise.all([r.fetchVideo(t.postId),r.fetchVideos(t.searchTerm)]);case 3:return n=e.sent,a=Object(b.a)(n,2),o=a[0],c=a[1],o[0]&&!c.find((function(e){return e.ID===o[0].ID}))&&c.push(o[0]),c=c.map((function(e){return{label:e.post_title||I("Untitled","presto-player"),value:e.ID}})),r.setState({videos:c}),e.abrupt("return",c);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object(l.a)(Object(g.a)(r),"_onChange",(function(e){r.props._onChange(r.props.name,e.value)})),Object(l.a)(Object(g.a)(r),"_onEditVideoClick",(function(){var e=r.props.value;e&&window.open("/wp-admin/post.php?post=".concat(e,"&action=edit"),"_blank").focus()})),Object(l.a)(Object(g.a)(r),"_onCreateVideoClick",(function(){window.open("/wp-admin/post-new.php?post_type=pp_video_block","_blank").focus()})),Object(l.a)(Object(g.a)(r),"currentVideoLabel",(function(){if(!r.state.videos)return"";var e=(r.state.videos||[]).find((function(e){return e.value===parseInt(r.props.value)}));return e?e.label:""})),r.state={videos:[]};return r.debouncedLoadVideos=x()((function(e){return r.loadVideos({searchTerm:e})}),500,{leading:!0}),r}return Object(c.a)(n,[{key:"render",value:function(){var e=this;return d.a.createElement("div",{className:"presto-player-divi-editor"},d.a.createElement("ul",{className:"presto-player-divi-editor__inputs"},d.a.createElement("li",null,d.a.createElement(T,{container:window.parent.document.body},d.a.createElement(V.a,{id:"prpd_video_selector-".concat(this.props.name),className:"prpd_video_selector",cacheOptions:!0,defaultOptions:!0,name:this.props.name,value:{value:this.props.value,label:this.currentVideoLabel()},onChange:this._onChange,loadOptions:function(t){return e.debouncedLoadVideos(t)}}))),d.a.createElement("li",null,d.a.createElement("label",null,I("Video Options","presto-player")),d.a.createElement("button",{type:"button",onClick:this._onEditVideoClick},I("Edit Video","presto-player"))),d.a.createElement("li",null,d.a.createElement("label",null,I("New Video","presto-player")),d.a.createElement("button",{type:"button",onClick:this._onCreateVideoClick},I("Create Video","presto-player")))))}}]),n}(p.Component);Object(l.a)(L,"slug","prpl_video_selector");var N=[L];a()(window).on("et_builder_api_ready",(function(e,t){t.registerModules(_),t.registerModalFields(N)}))}},[[43,1,2]]]);
//# sourceMappingURL=admin-1a1a82cb.js.map